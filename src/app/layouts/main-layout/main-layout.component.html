<div class="main-layout-container">
<app-sidebar 
  [isOpen]="showSidebar" 
  [selectedItem]="selectedMenuItem"
  [shouldAnimate]="shouldAnimateSidebar"
  (closeSidebar)="showSidebar = false"
  (backToHome)="onBackToHome()"
  (toggleSidebar)="showSidebar = !showSidebar"
  (voiceAction)="onSidebarVoiceAction($event)">
</app-sidebar>

  <div class="content-area" [class.content-shifted]="showSidebar">
    <router-outlet></router-outlet>
  </div>

  <div class="voice-control-bar" [ngClass]="getVoiceControlBarClasses()" [ngStyle]="getVoiceControlBarStyles()">
    <div class="voice-control-center">
      <button class="microphone-button" (click)="onMicrophoneClick()">
        <img src="/assets/icons/microphone.svg" alt="Microfono" class="microphone-icon" />
        <span class="microphone-pulse" [style.--pulse-intensity]="conversationState.speakingIntensity"></span>
      </button>
      <div class="voice-status-text">
        <span *ngIf="conversationService.isSDKLoading()">Caricamento SDK...</span>
        <span *ngIf="!conversationService.isSDKLoading()">
          {{ getVoiceControlText() }}
        </span>
      </div>
      <div class="agent-name-display">
        {{ getCurrentAgentNameForDisplay() }}
        <span *ngIf="conversationState.status === 'connected'" class="status-dot"></span>
      </div>
    </div>
  </div>
</div>